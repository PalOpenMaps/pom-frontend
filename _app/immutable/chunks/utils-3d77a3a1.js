var O={},R={},D=34,y=10,U=13;function I(r){return new Function("d","return {"+r.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function B(r,e){var n=I(r);return function(i,a){return e(n(i),a,r)}}function b(r){var e=Object.create(null),n=[];return r.forEach(function(i){for(var a in i)a in e||n.push(e[a]=a)}),n}function u(r,e){var n=r+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function M(r){return r<0?"-"+u(-r,6):r>9999?"+"+u(r,6):u(r,4)}function S(r){var e=r.getUTCHours(),n=r.getUTCMinutes(),i=r.getUTCSeconds(),a=r.getUTCMilliseconds();return isNaN(r)?"Invalid Date":M(r.getUTCFullYear())+"-"+u(r.getUTCMonth()+1,2)+"-"+u(r.getUTCDate(),2)+(a?"T"+u(e,2)+":"+u(n,2)+":"+u(i,2)+"."+u(a,3)+"Z":i?"T"+u(e,2)+":"+u(n,2)+":"+u(i,2)+"Z":n||e?"T"+u(e,2)+":"+u(n,2)+"Z":"")}function Z(r){var e=new RegExp('["'+r+`
\r]`),n=r.charCodeAt(0);function i(t,s){var _,p,f=a(t,function(m,g){if(_)return _(m,g-1);p=m,_=s?B(m,s):I(m)});return f.columns=p||[],f}function a(t,s){var _=[],p=t.length,f=0,m=0,g,E=p<=0,C=!1;t.charCodeAt(p-1)===y&&--p,t.charCodeAt(p-1)===U&&--p;function F(){if(E)return R;if(C)return C=!1,O;var N,A=f,j;if(t.charCodeAt(A)===D){for(;f++<p&&t.charCodeAt(f)!==D||t.charCodeAt(++f)===D;);return(N=f)>=p?E=!0:(j=t.charCodeAt(f++))===y?C=!0:j===U&&(C=!0,t.charCodeAt(f)===y&&++f),t.slice(A+1,N-1).replace(/""/g,'"')}for(;f<p;){if((j=t.charCodeAt(N=f++))===y)C=!0;else if(j===U)C=!0,t.charCodeAt(f)===y&&++f;else if(j!==n)continue;return t.slice(A,N)}return E=!0,t.slice(A,p)}for(;(g=F())!==R;){for(var w=[];g!==O&&g!==R;)w.push(g),g=F();s&&(w=s(w,m++))==null||_.push(w)}return _}function h(t,s){return t.map(function(_){return s.map(function(p){return T(_[p])}).join(r)})}function l(t,s){return s==null&&(s=b(t)),[s.map(T).join(r)].concat(h(t,s)).join(`
`)}function o(t,s){return s==null&&(s=b(t)),h(t,s).join(`
`)}function c(t){return t.map(d).join(`
`)}function d(t){return t.map(T).join(r)}function T(t){return t==null?"":t instanceof Date?S(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:i,parseRows:a,format:l,formatBody:o,formatRows:c,formatRow:d,formatValue:T}}var H=Z(","),L=H.parse;function P(r){for(var e in r){var n=r[e].trim(),i,a;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(i=+n))n=i;else if(a=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))v&&!!a[4]&&!a[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;r[e]=n}return r}const v=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function V(r,e,n=window.fetch){let a=await(await n(r)).text(),h=L(a,P);h.sort((o,c)=>o.name_en.localeCompare(c.name_en));let l={type:"FeatureCollection",features:[]};for(const o of h.filter(c=>c.change_2016!="Built & abandoned"&&c.lng)){let c={type:"Feature",geometry:{type:"Point",coordinates:[o.lng,o.lat]},properties:{type:o.type_2016?o.type_2016:o.type_1945,group:o.grp_2016?o.grp_2016:o.grp_1945,color:e[o.change_2016].color,...o}};c.properties.name_ar=o.name_ar?o.name_ar:o.name_en,l.features.push(c)}return l}async function Y(r,e,n=window.fetch){let a=await(await n(r)).json();a.sort((l,o)=>l.layer-o.layer);let h={type:"FeatureCollection",features:[]};for(const l of a){let o=Object.fromEntries(Object.entries(l).filter(([d])=>d!="boundaries")),c=e.find(d=>d.id==l.layer);o.year=o.year?o.year.split("-")[0]:c.start_year.split("-")[0],h.features.push({properties:{...o,scale:c.scale,author:c.attribution.split(",")[0]},geometry:l.boundaries})}return h}function z(r,e,n){return n!="en"&&e[n]&&e[n][r]?e[n][r]:r}function J(r){let e=r.properties;return{p1945:{pop:e.pop_1945,pal:e.pal_1945&&e.pop_1945?100*e.pal_1945/e.pop_1945:null,jsh:e.jsh_1945&&e.pop_1945?100*e.jsh_1945/e.pop_1945:null,oth:null},p2016:{pop:e.pop_2016,pal:e.pal_2016&&e.pop_2016?100*e.pal_2016/e.pop_2016:null,jsh:e.jsh_2016&&e.pop_2016?100*e.jsh_2016/e.pop_2016:null,oth:e.oth_2016&&e.pop_2016?100*e.oth_2016/e.pop_2016:null}}}export{Y as a,V as g,z as i,J as m};
