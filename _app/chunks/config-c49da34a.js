var L=Object.defineProperty,M=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var O=(t,e,r)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,D=(t,e)=>{for(var r in e||(e={}))Z.call(e,r)&&O(t,r,e[r]);if(F)for(var r of F(e))H.call(e,r)&&O(t,r,e[r]);return t},z=(t,e)=>M(t,P(e));var B={},v={},R=34,C=10,E=13;function S(t){return new Function("d","return {"+t.map(function(e,r){return JSON.stringify(e)+": d["+r+'] || ""'}).join(",")+"}")}function V(t,e){var r=S(t);return function(a,s){return e(r(a),s,t)}}function I(t){var e=Object.create(null),r=[];return t.forEach(function(a){for(var s in a)s in e||r.push(e[s]=s)}),r}function c(t,e){var r=t+"",a=r.length;return a<e?new Array(e-a+1).join(0)+r:r}function q(t){return t<0?"-"+c(-t,6):t>9999?"+"+c(t,6):c(t,4)}function W(t){var e=t.getUTCHours(),r=t.getUTCMinutes(),a=t.getUTCSeconds(),s=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":q(t.getUTCFullYear())+"-"+c(t.getUTCMonth()+1,2)+"-"+c(t.getUTCDate(),2)+(s?"T"+c(e,2)+":"+c(r,2)+":"+c(a,2)+"."+c(s,3)+"Z":a?"T"+c(e,2)+":"+c(r,2)+":"+c(a,2)+"Z":r||e?"T"+c(e,2)+":"+c(r,2)+"Z":"")}function Y(t){var e=new RegExp('["'+t+`
\r]`),r=t.charCodeAt(0);function a(n,i){var h,u,p=s(n,function(_,m){if(h)return h(_,m-1);u=_,h=i?V(_,i):S(_)});return p.columns=u||[],p}function s(n,i){var h=[],u=n.length,p=0,_=0,m,N=u<=0,y=!1;n.charCodeAt(u-1)===C&&--u,n.charCodeAt(u-1)===E&&--u;function U(){if(N)return v;if(y)return y=!1,B;var b,A=p,j;if(n.charCodeAt(A)===R){for(;p++<u&&n.charCodeAt(p)!==R||n.charCodeAt(++p)===R;);return(b=p)>=u?N=!0:(j=n.charCodeAt(p++))===C?y=!0:j===E&&(y=!0,n.charCodeAt(p)===C&&++p),n.slice(A+1,b-1).replace(/""/g,'"')}for(;p<u;){if((j=n.charCodeAt(b=p++))===C)y=!0;else if(j===E)y=!0,n.charCodeAt(p)===C&&++p;else if(j!==r)continue;return n.slice(A,b)}return N=!0,n.slice(A,u)}for(;(m=U())!==v;){for(var w=[];m!==B&&m!==v;)w.push(m),m=U();i&&(w=i(w,_++))==null||h.push(w)}return h}function d(n,i){return n.map(function(h){return i.map(function(u){return T(h[u])}).join(t)})}function f(n,i){return i==null&&(i=I(n)),[i.map(T).join(t)].concat(d(n,i)).join(`
`)}function o(n,i){return i==null&&(i=I(n)),d(n,i).join(`
`)}function l(n){return n.map(g).join(`
`)}function g(n){return n.map(T).join(t)}function T(n){return n==null?"":n instanceof Date?W(n):e.test(n+="")?'"'+n.replace(/"/g,'""')+'"':n}return{parse:a,parseRows:s,format:f,formatBody:o,formatRows:l,formatRow:g,formatValue:T}}var k=Y(","),J=k.parse;function K(t){for(var e in t){var r=t[e].trim(),a,s;if(!r)r=null;else if(r==="true")r=!0;else if(r==="false")r=!1;else if(r==="NaN")r=NaN;else if(!isNaN(a=+r))r=a;else if(s=r.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))Q&&!!s[4]&&!s[7]&&(r=r.replace(/-/g,"/").replace(/T/," ")),r=new Date(r);else continue;t[e]=r}return t}const Q=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function G(t,e,r=window.fetch){let s=await(await r(t)).text(),d=J(s,K);d.sort((o,l)=>o.name_en.localeCompare(l.name_en));let f={type:"FeatureCollection",features:[]};for(const o of d.filter(l=>l.change_2016!="Built & abandoned")){let l={type:"Feature",geometry:{type:"Point",coordinates:[o.lng,o.lat]},properties:D({type:o.type_2016?o.type_2016:o.type_1945,group:o.grp_2016?o.grp_2016:o.grp_1945,color:e[o.change_2016].color},o)};l.properties.name_ar=o.name_ar?o.name_ar:o.name_en,f.features.push(l)}return f}async function X(t,e,r=window.fetch){let s=await(await r(t)).json();s.sort((f,o)=>f.layer-o.layer);let d={type:"FeatureCollection",features:[]};for(const f of s){let o=Object.fromEntries(Object.entries(f).filter(([g])=>g!="boundaries")),l=e.find(g=>g.id==f.layer);o.year=o.year?o.year.split("-")[0]:l.start_year.split("-")[0],d.features.push({properties:z(D({},o),{scale:l.scale,author:l.attribution.split(",")[0]}),geometry:f.boundaries})}return d}function x(t,e,r="en",a="en"){return e[r]&&e[r][t]?e[r][t]:e[a]&&e[a][t]?e[a][t]:t}function ee(t){let e=t.properties;return{p1945:{pop:e.pop_1945,pal:e.pal_1945&&e.pop_1945?100*e.pal_1945/e.pop_1945:null,jsh:e.jsh_1945&&e.pop_1945?100*e.jsh_1945/e.pop_1945:null,oth:null},p2016:{pop:e.pop_2016,pal:e.pal_2016&&e.pop_2016?100*e.pal_2016/e.pop_2016:null,jsh:e.jsh_2016&&e.pop_2016?100*e.jsh_2016/e.pop_2016:null,oth:e.oth_2016&&e.pop_2016?100*e.oth_2016/e.pop_2016:null}}}function te(t,e=!1){return{version:8,glyphs:"https://cdn.jsdelivr.net/gh/bothness/basemaps/fonts/{fontstack}/{range}.pbf",sources:{source:{type:"raster",tiles:[t.url],tileSize:256,attribution:t.attribution,minzoom:0,maxzoom:17}},layers:[{id:"base",type:"raster",source:"source",paint:{"raster-saturation":e?-.85:0}},{id:"overlays-div",type:"background",paint:{"background-opacity":0}},{id:"places-div",type:"background",paint:{"background-opacity":0}}]}}function re(t=1e3){return new Promise(e=>setTimeout(e,t))}const ne="https://docs.google.com/spreadsheets/d/1LejOouylx6u_TKF_1BxvV_B7uI34M4zIWyoc8LozATo/gviz/tq?tqx=out%3Acsv&sheet=database",oe="https://palopenmaps.org/api/layers/?format=json",ae="https://palopenmaps.org/api/sheets/?format=json",se={Remaining:{name:"Remaining",color:"#7ac943",selected:!0},Depopulated:{name:"Depopulated",color:"#fcee21",selected:!0},Appropriated:{name:"Depopulated & appropriated",color:"#f7931e",selected:!0},"Built over":{name:"Depopulated & built over",color:"#ff0000",selected:!0},Abandoned:{name:"Abandoned",color:"#0099ff",selected:!1},"Newly built":{name:"New locality",color:"#777777",selected:!1}};export{X as a,ne as b,ae as c,ee as d,re as e,G as g,x as i,oe as l,te as m,se as s};
